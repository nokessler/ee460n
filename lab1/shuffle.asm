   .ORIG x3000
   ;INITIALIZATION, LOAD x4000 INTO R0 AND CONTROL MASK INTO R1
   LEA R1, ADR
   LDW R0, R1, #0
   LDB R1, R0, #4
   ;STORE DATA IN LOOP
   ;R7 IS COUNTER
   ;FIRST RUN STORES DATA IN x4005
   AND R7, R7, #0
   ;DETERMINE WHICH DATA TO LOAD
LOOP  ADD R2, R1, #0
   ADD R6, R7, R7
   BRZ MASK
   ADD R5, R7, #-1
   BRZ ONE
   ADD R5, R7, #-2
   BRZ TWO
   RSHFA R2, R2, #6
   BRNZP MASK
TWO   RSHFA R2, R2, #4
   BRNZP MASK
ONE   RSHFA R2, R2, #2
   BRNZP MASK
MASK  AND R2, R2, x0003
   ;LOAD AND STORE DATA
   ADD R2, R0, R2
   LDB R3, R2, #0
   ADD R6, R0, #5
   ADD R6, R6, R7
   STB R3, R6, #0
   ADD R7, R7, #1
   ADD R6, R7, #-4
   BRN LOOP
   HALT
ADR   .FILL x4000
   .END
